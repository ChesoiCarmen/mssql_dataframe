parameters:
- name: remote_agent
  displayName: Remote Agent (Unselect to Run Local)
  type: boolean
  default: True

steps:

  # tasks for remote agent only
  - task: UsePythonVersion@0
    condition: eq(${{ parameters.remote_agent }}, True)
    inputs:
      versionSpec: '3.9'
    displayName: 'Use Python 3.9'

  # tasks for local agent only
  # TODO: local agent ensure Python is installed
  
  # tasks for local or remote
  - task: PowerShell@2
    displayName: 'Start SQL Server Express LocalDB'
    inputs:
      targetType: 'inline'
      script: 'sqllocaldb start mssqllocaldb'
  - task: PythonScript@0
    displayName: Output Debugging Info
    inputs:
      scriptSource: inline
      script: |
        import sys
        from mssql_dataframe import SQLServer
        sql = SQLServer(server=r"(localdb)\mssqllocaldb")
        sys.stdout.write("Connection: \n"+str(sql._conn)+"\n")
        sys.stdout.write("Versions: \n"+str(sql._versions)+"\n")
      pythonInterpreter: $(Build.SourcesDirectory)\env\Scripts\python.exe
  